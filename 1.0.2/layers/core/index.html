<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Core Layers - Keras Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Core Layers";
    var mkdocs_page_input_path = "layers/core.md";
    var mkdocs_page_url = "/layers/core/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-61785484-1', 'keras.io');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Keras Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Getting started</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../getting-started/sequential-model-guide/">Guide to the Sequential model</a>
                </li>
                <li class="">
                    
    <a class="" href="../../getting-started/functional-api-guide/">Guide to the Functional API</a>
                </li>
                <li class="">
                    
    <a class="" href="../../getting-started/faq/">FAQ</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Models</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../models/about-keras-models/">About Keras models</a>
                </li>
                <li class="">
                    
    <a class="" href="../../models/sequential/">Sequential</a>
                </li>
                <li class="">
                    
    <a class="" href="../../models/model/">Model (functional API)</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Layers</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../about-keras-layers/">About Keras layers</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Core Layers</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#dense">Dense</a></li>
    

    <li class="toctree-l3"><a href="#activation">Activation</a></li>
    

    <li class="toctree-l3"><a href="#dropout">Dropout</a></li>
    

    <li class="toctree-l3"><a href="#flatten">Flatten</a></li>
    

    <li class="toctree-l3"><a href="#reshape">Reshape</a></li>
    

    <li class="toctree-l3"><a href="#permute">Permute</a></li>
    

    <li class="toctree-l3"><a href="#repeatvector">RepeatVector</a></li>
    

    <li class="toctree-l3"><a href="#merge">Merge</a></li>
    

    <li class="toctree-l3"><a href="#lambda">Lambda</a></li>
    

    <li class="toctree-l3"><a href="#activityregularization">ActivityRegularization</a></li>
    

    <li class="toctree-l3"><a href="#masking">Masking</a></li>
    

    <li class="toctree-l3"><a href="#highway">Highway</a></li>
    

    <li class="toctree-l3"><a href="#maxoutdense">MaxoutDense</a></li>
    

    <li class="toctree-l3"><a href="#timedistributeddense">TimeDistributedDense</a></li>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../convolutional/">Convolutional Layers</a>
                </li>
                <li class="">
                    
    <a class="" href="../recurrent/">Recurrent Layers</a>
                </li>
                <li class="">
                    
    <a class="" href="../embeddings/">Embedding Layers</a>
                </li>
                <li class="">
                    
    <a class="" href="../advanced-activations/">Advanced Activations Layers</a>
                </li>
                <li class="">
                    
    <a class="" href="../normalization/">Normalization Layers</a>
                </li>
                <li class="">
                    
    <a class="" href="../noise/">Noise layers</a>
                </li>
                <li class="">
                    
    <a class="" href="../wrappers/">Layer wrappers</a>
                </li>
                <li class="">
                    
    <a class="" href="../writing-your-own-keras-layers/">Writing your own Keras layers</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Preprocessing</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../preprocessing/sequence/">Sequence Preprocessing</a>
                </li>
                <li class="">
                    
    <a class="" href="../../preprocessing/text/">Text Preprocessing</a>
                </li>
                <li class="">
                    
    <a class="" href="../../preprocessing/image/">Image Preprocessing</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../objectives/">Objectives</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../optimizers/">Optimizers</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../activations/">Activations</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../callbacks/">Callbacks</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../datasets/">Datasets</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../backend/">Backend</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../initializations/">Initializations</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../regularizers/">Regularizers</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../constraints/">Constraints</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../visualization/">Visualization</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../scikit-learn-api/">Scikit-learn API</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Keras Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Layers &raquo;</li>
        
      
    
    <li>Core Layers</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="http://github.com/fchollet/keras/edit/master/docs/layers/core.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p><span style="float:right;"><a href="https://github.com/fchollet/keras/blob/master/keras/layers/core.py#L507">[source]</a></span></p>
<h3 id="dense">Dense</h3>
<pre><code class="python">keras.layers.core.Dense(output_dim, init='glorot_uniform', activation='linear', weights=None, W_regularizer=None, b_regularizer=None, activity_regularizer=None, W_constraint=None, b_constraint=None, input_dim=None, bias=True)
</code></pre>

<p>Just your regular fully connected NN layer.</p>
<p><strong>Example</strong></p>
<pre><code class="python"># as first layer in a sequential model:
model = Sequential()
model.add(Dense(32, input_dim=16))
# now the model will take as input arrays of shape (*, 16)
# and output arrays of shape (*, 32)

# this is equivalent to the above:
model = Sequential()
model.add(Dense(32, input_shape=(16,)))

# after the first layer, you don't need to specify
# the size of the input anymore:
model.add(Dense(32))
</code></pre>

<p><strong>Arguments</strong></p>
<ul>
<li><strong>output_dim</strong>: int &gt; 0.</li>
<li><strong>init</strong>: name of initialization function for the weights of the layer
    (see <a href="../../initializations/">initializations</a>),
    or alternatively, Theano function to use for weights
    initialization. This parameter is only relevant
    if you don't pass a <code>weights</code> argument.</li>
<li><strong>activation</strong>: name of activation function to use
    (see <a href="../../activations/">activations</a>),
    or alternatively, elementwise Theano function.
    If you don't specify anything, no activation is applied
    (ie. "linear" activation: a(x) = x).</li>
<li><strong>weights</strong>: list of numpy arrays to set as initial weights.
    The list should have 2 elements, of shape <code>(input_dim, output_dim)</code>
    and (output_dim,) for weights and biases respectively.</li>
<li><strong>W_regularizer</strong>: instance of <a href="../../regularizers/">WeightRegularizer</a>
    (eg. L1 or L2 regularization), applied to the main weights matrix.</li>
<li><strong>b_regularizer</strong>: instance of <a href="../../regularizers/">WeightRegularizer</a>,
    applied to the bias.</li>
<li><strong>activity_regularizer</strong>: instance of <a href="../../regularizers/">ActivityRegularizer</a>,
    applied to the network output.</li>
<li><strong>W_constraint</strong>: instance of the <a href="../../constraints/">constraints</a> module
    (eg. maxnorm, nonneg), applied to the main weights matrix.</li>
<li><strong>b_constraint</strong>: instance of the <a href="../../constraints/">constraints</a> module,
    applied to the bias.</li>
<li><strong>input_dim</strong>: dimensionality of the input (integer).
    This argument (or alternatively, the keyword argument <code>input_shape</code>)
    is required when using this layer as the first layer in a model.</li>
<li><strong>bias</strong>: boolean
    Default True;
    Setting it to False will remove the bias (b) from all calculations.</li>
</ul>
<p><strong>Input shape</strong></p>
<p>2D tensor with shape: <code>(nb_samples, input_dim)</code>.</p>
<p><strong>Output shape</strong></p>
<p>2D tensor with shape: <code>(nb_samples, output_dim)</code>.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/fchollet/keras/blob/master/keras/layers/core.py#L96">[source]</a></span></p>
<h3 id="activation">Activation</h3>
<pre><code class="python">keras.layers.core.Activation(activation)
</code></pre>

<p>Applies an activation function to an output.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>activation</strong>: name of activation function to use<ul>
<li><strong>(see</strong>: <a href="../../activations/">activations</a>),
or alternatively, a Theano or TensorFlow operation.</li>
</ul>
</li>
</ul>
<p><strong>Input shape</strong></p>
<p>Arbitrary. Use the keyword argument <code>input_shape</code>
(tuple of integers, does not include the samples axis)
when using this layer as the first layer in a model.</p>
<p><strong>Output shape</strong></p>
<p>Same shape as input.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/fchollet/keras/blob/master/keras/layers/core.py#L67">[source]</a></span></p>
<h3 id="dropout">Dropout</h3>
<pre><code class="python">keras.layers.core.Dropout(p)
</code></pre>

<p>Applies Dropout to the input. Dropout consists in randomly setting
a fraction <code>p</code> of input units to 0 at each update during training time,
which helps prevent overfitting.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>p</strong>: float between 0 and 1. Fraction of the input units to drop.</li>
</ul>
<p><strong>References</strong></p>
<ul>
<li><a href="http://www.cs.toronto.edu/~rsalakhu/papers/srivastava14a.pdf">Dropout: A Simple Way to Prevent Neural Networks from Overfitting</a></li>
</ul>
<hr />
<p><span style="float:right;"><a href="https://github.com/fchollet/keras/blob/master/keras/layers/core.py#L282">[source]</a></span></p>
<h3 id="flatten">Flatten</h3>
<pre><code class="python">keras.layers.core.Flatten()
</code></pre>

<p>Flattens the input. Does not affect the batch size.</p>
<p><strong>Example</strong></p>
<pre><code class="python">model = Sequential()
model.add(Convolution2D(64, 3, 3, border_mode='same', input_shape=(3, 32, 32)))
# now: model.output_shape == (None, 64, 32, 32)

model.add(Flatten())
# now: model.output_shape == (None, 65536)
</code></pre>

<hr />
<p><span style="float:right;"><a href="https://github.com/fchollet/keras/blob/master/keras/layers/core.py#L126">[source]</a></span></p>
<h3 id="reshape">Reshape</h3>
<pre><code class="python">keras.layers.core.Reshape(target_shape)
</code></pre>

<p>Reshapes an output to a certain shape.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>target_shape</strong>: target shape. Tuple of integers,
    does not include the samples dimension (batch size).</li>
</ul>
<p><strong>Input shape</strong></p>
<p>Arbitrary, although all dimensions in the input shaped must be fixed.
Use the keyword argument <code>input_shape</code>
(tuple of integers, does not include the samples axis)
when using this layer as the first layer in a model.</p>
<p><strong>Output shape</strong></p>
<p><code>(batch_size,) + target_shape</code></p>
<p><strong>Example</strong></p>
<pre><code class="python"># as first layer in a Sequential model
model = Sequential()
model.add(Reshape((3, 4), input_shape=(12,)))
# now: model.output_shape == (None, 3, 4)
# note: `None` is the batch dimension

# as intermediate layer in a Sequential model
model.add(Reshape((6, 2)))
# now: model.output_shape == (None, 6, 2)
</code></pre>

<hr />
<p><span style="float:right;"><a href="https://github.com/fchollet/keras/blob/master/keras/layers/core.py#L232">[source]</a></span></p>
<h3 id="permute">Permute</h3>
<pre><code class="python">keras.layers.core.Permute(dims)
</code></pre>

<p>Permutes the dimensions of the input according to a given pattern.</p>
<p>Useful for e.g. connecting RNNs and convnets together.</p>
<p><strong>Example</strong></p>
<pre><code class="python">model = Sequential()
model.add(Permute((2, 1), input_shape=(10, 64)))
# now: model.output_shape == (None, 64, 10)
# note: `None` is the batch dimension
</code></pre>

<p><strong>Arguments</strong></p>
<ul>
<li><strong>dims</strong>: Tuple of integers. Permutation pattern, does not include the
    samples dimension. Indexing starts at 1.
    For instance, <code>(2, 1)</code> permutes the first and second dimension
    of the input.</li>
</ul>
<p><strong>Input shape</strong></p>
<p>Arbitrary. Use the keyword argument <code>input_shape</code>
(tuple of integers, does not include the samples axis)
when using this layer as the first layer in a model.</p>
<p><strong>Output shape</strong></p>
<p>Same as the input shape, but with the dimensions re-ordered according
to the specified pattern.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/fchollet/keras/blob/master/keras/layers/core.py#L314">[source]</a></span></p>
<h3 id="repeatvector">RepeatVector</h3>
<pre><code class="python">keras.layers.core.RepeatVector(n)
</code></pre>

<p>Repeats the input n times.</p>
<p><strong>Example</strong></p>
<pre><code class="python">model = Sequential()
model.add(Dense(32, input_dim=32))
# now: model.output_shape == (None, 32)
# note: `None` is the batch dimension

model.add(RepeatVector(3))
# now: model.output_shape == (None, 3, 32)
</code></pre>

<p><strong>Arguments</strong></p>
<ul>
<li><strong>n</strong>: integer, repetition factor.</li>
</ul>
<p><strong>Input shape</strong></p>
<p>2D tensor of shape <code>(nb_samples, features)</code>.</p>
<p><strong>Output shape</strong></p>
<p>3D tensor of shape <code>(nb_samples, n, features)</code>.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/fchollet/keras/blob/master/keras/engine/topology.py#L1036">[source]</a></span></p>
<h3 id="merge">Merge</h3>
<pre><code class="python">keras.engine.topology.Merge(layers=None, mode='sum', concat_axis=-1, dot_axes=-1, output_shape=None, node_indices=None, tensor_indices=None, name=None)
</code></pre>

<p>A <code>Merge</code> layer can be used to merge a list of tensors
into a single tensor, following some merge <code>mode</code>.</p>
<p><strong>Example usage</strong></p>
<pre><code class="python">model1 = Sequential()
model1.add(Dense(32))

model2 = Sequential()
model2.add(Dense(32))

merged_model = Sequential()
merged_model.add(Merge([model1, model2], mode='concat', concat_axis=1)
- ____TODO__: would this actually work? it needs to.__

# achieve this with get_source_inputs in Sequential.
</code></pre>

<p><strong>Arguments</strong></p>
<ul>
<li><strong>layers</strong>: can be a list of Keras tensors or
    a list of layer instances. Must be more
    than one layer/tensor.</li>
<li><strong>mode</strong>: string or lambda/function. If string, must be one<ul>
<li><strong>of</strong>: 'sum', 'mul', 'concat', 'ave', 'cos', 'dot'.
If lambda/function, it should take as input a list of tensors
and return a single tensor.</li>
</ul>
</li>
<li><strong>concat_axis</strong>: integer, axis to use in mode <code>concat</code>.</li>
<li><strong>dot_axes</strong>: integer or tuple of integers, axes to use in mode <code>dot</code>.</li>
<li><strong>output_shape</strong>: shape tuple (tuple of integers), or lambda/function
    to compute output_shape (only if merge mode is a lambda/function).
    If the latter case, it should take as input a list of shape tuples<ul>
<li><strong>(1</strong>:1 mapping to input tensors) and return a single shape tuple.</li>
</ul>
</li>
<li><strong>node_indices</strong>: optional list of integers containing
    the output node index for each input layer
    (in case some input layers have multiple output nodes).
    will default to an array of 0s if not provided.</li>
<li><strong>tensor_indices</strong>: optional list of indices of output tensors
    to consider for merging
    (in case some input layer node returns multiple tensors).</li>
</ul>
<hr />
<p><span style="float:right;"><a href="https://github.com/fchollet/keras/blob/master/keras/layers/core.py#L355">[source]</a></span></p>
<h3 id="lambda">Lambda</h3>
<pre><code class="python">keras.layers.core.Lambda(function, output_shape=None, arguments={})
</code></pre>

<p>Used for evaluating an arbitrary Theano / TensorFlow expression
on the output of the previous layer.</p>
<p><strong>Examples</strong></p>
<pre><code class="python"># add a x -&gt; x^2 layer
model.add(Lambda(lambda x: x ** 2))
</code></pre>

<pre><code class="python"># add a layer that returns the concatenation
# of the positive part of the input and
# the opposite of the negative part

def antirectifier(x):
    x -= K.mean(x, axis=1, keepdims=True)
    x = K.l2_normalize(x, axis=1)
    pos = K.relu(x)
    neg = K.relu(-x)
    return K.concatenate([pos, neg], axis=1)

def antirectifier_output_shape(input_shape):
    shape = list(input_shape)
    assert len(shape) == 2  # only valid for 2D tensors
    shape[-1] *= 2
    return tuple(shape)

model.add(Lambda(antirectifier, output_shape=antirectifier_output_shape))
</code></pre>

<p><strong>Arguments</strong></p>
<ul>
<li><strong>function</strong>: The function to be evaluated.
    Takes one argument: the output of previous layer</li>
<li><strong>output_shape</strong>: Expected output shape from function.
    Could be a tuple or a function of the shape of the input</li>
<li><strong>arguments</strong>: optional dictionary of keyword arguments to be passed
    to the function.</li>
</ul>
<p><strong>Input shape</strong></p>
<p>Arbitrary. Use the keyword argument input_shape
(tuple of integers, does not include the samples axis)
when using this layer as the first layer in a model.</p>
<p><strong>Output shape</strong></p>
<p>Specified by <code>output_shape</code> argument.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/fchollet/keras/blob/master/keras/layers/core.py#L652">[source]</a></span></p>
<h3 id="activityregularization">ActivityRegularization</h3>
<pre><code class="python">keras.layers.core.ActivityRegularization(l1=0.0, l2=0.0)
</code></pre>

<p>Layer that passes through its input unchanged, but applies an update
to the cost function based on the activity.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>l1</strong>: L1 regularization factor (positive float).</li>
<li><strong>l2</strong>: L2 regularization factor (positive float).</li>
</ul>
<p><strong>Input shape</strong></p>
<p>Arbitrary. Use the keyword argument <code>input_shape</code>
(tuple of integers, does not include the samples axis)
when using this layer as the first layer in a model.</p>
<p><strong>Output shape</strong></p>
<p>Same shape as input.</p>
<hr />
<p><span style="float:right;"><a href="https://github.com/fchollet/keras/blob/master/keras/layers/core.py#L20">[source]</a></span></p>
<h3 id="masking">Masking</h3>
<pre><code class="python">keras.layers.core.Masking(mask_value=0.0)
</code></pre>

<p>Masks an input sequence by using a mask value to
identify timesteps to be skipped.</p>
<p>For each timestep in the input tensor (dimension #1 in the tensor),
if all values in the input tensor at that timestep
are equal to <code>mask_value</code>, then the timestep will masked (skipped)
in all downstream layers (as long as they support masking).</p>
<p>If any downstream layer does not support masking yet receives such
an input mask, an exception will be raised.</p>
<p><strong>Example</strong></p>
<p>Consider a Numpy data array <code>x</code> of shape <code>(samples, timesteps, features)</code>,
to be fed to a LSTM layer.
You want to mask timestep #3 and #5 because you lack data for
these timesteps. You can:</p>
<ul>
<li>set <code>x[:, 3, :] = 0.</code> and <code>x[:, 5, :] = 0.</code></li>
<li>insert a <code>Masking</code> layer with <code>mask_value=0.</code> before the LSTM layer:</li>
</ul>
<pre><code class="python">model = Sequential()
model.add(Masking(mask_value=0., input_shape=(timesteps, features)))
model.add(LSTM(32))
</code></pre>

<hr />
<p><span style="float:right;"><a href="https://github.com/fchollet/keras/blob/master/keras/layers/core.py#L818">[source]</a></span></p>
<h3 id="highway">Highway</h3>
<pre><code class="python">keras.layers.core.Highway(init='glorot_uniform', transform_bias=-2, activation='linear', weights=None, W_regularizer=None, b_regularizer=None, activity_regularizer=None, W_constraint=None, b_constraint=None, input_dim=None)
</code></pre>

<p>Densely connected highway network,
a natural extension of LSTMs to feedforward networks.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>init</strong>: name of initialization function for the weights of the layer
    (see <a href="../../initializations/">initializations</a>),
    or alternatively, Theano function to use for weights
    initialization. This parameter is only relevant
    if you don't pass a <code>weights</code> argument.</li>
<li><strong>transform_bias</strong>: value for the bias to take on initially (default -2)</li>
<li><strong>activation</strong>: name of activation function to use
    (see <a href="../../activations/">activations</a>),
    or alternatively, elementwise Theano function.
    If you don't specify anything, no activation is applied
    (ie. "linear" activation: a(x) = x).</li>
<li><strong>weights</strong>: list of numpy arrays to set as initial weights.
    The list should have 2 elements, of shape <code>(input_dim, output_dim)</code>
    and (output_dim,) for weights and biases respectively.</li>
<li><strong>W_regularizer</strong>: instance of <a href="../../regularizers/">WeightRegularizer</a>
    (eg. L1 or L2 regularization), applied to the main weights matrix.</li>
<li><strong>b_regularizer</strong>: instance of <a href="../../regularizers/">WeightRegularizer</a>,
    applied to the bias.</li>
<li><strong>activity_regularizer</strong>: instance of <a href="../../regularizers/">ActivityRegularizer</a>,
    applied to the network output.</li>
<li><strong>W_constraint</strong>: instance of the <a href="../../constraints/">constraints</a> module
    (eg. maxnorm, nonneg), applied to the main weights matrix.</li>
<li><strong>b_constraint</strong>: instance of the <a href="../../constraints/">constraints</a> module,
    applied to the bias.</li>
<li><strong>input_dim</strong>: dimensionality of the input (integer).
    This argument (or alternatively, the keyword argument <code>input_shape</code>)
    is required when using this layer as the first layer in a model.</li>
</ul>
<p><strong>Input shape</strong></p>
<p>2D tensor with shape: <code>(nb_samples, input_dim)</code>.</p>
<p><strong>Output shape</strong></p>
<p>2D tensor with shape: <code>(nb_samples, input_dim)</code>.</p>
<p><strong>References</strong></p>
<ul>
<li><a href="http://arxiv.org/pdf/1505.00387v2.pdf">Highway Networks</a></li>
</ul>
<hr />
<p><span style="float:right;"><a href="https://github.com/fchollet/keras/blob/master/keras/layers/core.py#L685">[source]</a></span></p>
<h3 id="maxoutdense">MaxoutDense</h3>
<pre><code class="python">keras.layers.core.MaxoutDense(output_dim, nb_feature=4, init='glorot_uniform', weights=None, W_regularizer=None, b_regularizer=None, activity_regularizer=None, W_constraint=None, b_constraint=None, input_dim=None)
</code></pre>

<p>A dense maxout layer.</p>
<p>A <code>MaxoutDense</code> layer takes the element-wise maximum of
<code>nb_feature</code> <code>Dense(input_dim, output_dim)</code> linear layers.
This allows the layer to learn a convex,
piecewise linear activation function over the inputs.</p>
<p>Note that this is a <em>linear</em> layer;
if you wish to apply activation function
(you shouldn't need to --they are universal function approximators),
an <code>Activation</code> layer must be added after.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>output_dim</strong>: int &gt; 0.</li>
<li><strong>nb_feature</strong>: number of Dense layers to use internally.</li>
<li><strong>init</strong>: name of initialization function for the weights of the layer
    (see <a href="../../initializations/">initializations</a>),
    or alternatively, Theano function to use for weights
    initialization. This parameter is only relevant
    if you don't pass a <code>weights</code> argument.</li>
<li><strong>activation</strong>: name of activation function to use
    (see <a href="../../activations/">activations</a>),
    or alternatively, elementwise Theano function.
    If you don't specify anything, no activation is applied
    (ie. "linear" activation: a(x) = x).</li>
<li><strong>weights</strong>: list of numpy arrays to set as initial weights.
    The list should have 2 elements, of shape <code>(input_dim, output_dim)</code>
    and (output_dim,) for weights and biases respectively.</li>
<li><strong>W_regularizer</strong>: instance of <a href="../../regularizers/">WeightRegularizer</a>
    (eg. L1 or L2 regularization), applied to the main weights matrix.</li>
<li><strong>b_regularizer</strong>: instance of <a href="../../regularizers/">WeightRegularizer</a>,
    applied to the bias.</li>
<li><strong>activity_regularizer</strong>: instance of <a href="../../regularizers/">ActivityRegularizer</a>,
    applied to the network output.</li>
<li><strong>W_constraint</strong>: instance of the <a href="../../constraints/">constraints</a> module
    (eg. maxnorm, nonneg), applied to the main weights matrix.</li>
<li><strong>b_constraint</strong>: instance of the <a href="../../constraints/">constraints</a> module,
    applied to the bias.</li>
<li><strong>input_dim</strong>: dimensionality of the input (integer).
    This argument (or alternatively, the keyword argument <code>input_shape</code>)
    is required when using this layer as the first layer in a model.</li>
</ul>
<p><strong>Input shape</strong></p>
<p>2D tensor with shape: <code>(nb_samples, input_dim)</code>.</p>
<p><strong>Output shape</strong></p>
<p>2D tensor with shape: <code>(nb_samples, output_dim)</code>.</p>
<p><strong>References</strong></p>
<ul>
<li><a href="http://arxiv.org/pdf/1302.4389.pdf">Maxout Networks</a></li>
</ul>
<hr />
<p><span style="float:right;"><a href="https://github.com/fchollet/keras/blob/master/keras/layers/core.py#L944">[source]</a></span></p>
<h3 id="timedistributeddense">TimeDistributedDense</h3>
<pre><code class="python">keras.layers.core.TimeDistributedDense(output_dim, init='glorot_uniform', activation='linear', weights=None, W_regularizer=None, b_regularizer=None, activity_regularizer=None, W_constraint=None, b_constraint=None, input_dim=None, input_length=None)
</code></pre>

<p>Apply a same Dense layer for each dimension[1] (time_dimension) input.
Especially useful after a recurrent network with 'return_sequence=True'.</p>
<ul>
<li><strong>Note</strong>: this layer is deprecated, prefer using the <code>TimeDistributed</code> wrapper:</li>
</ul>
<pre><code class="python">model.add(TimeDistributed(Dense(32)))
</code></pre>

<p><strong>Input shape</strong></p>
<p>3D tensor with shape <code>(nb_sample, time_dimension, input_dim)</code>.
<strong>Output shape</strong></p>
<p>3D tensor with shape <code>(nb_sample, time_dimension, output_dim)</code>.
<strong>Arguments</strong></p>
<ul>
<li><strong>output_dim</strong>: int &gt; 0.</li>
<li><strong>init</strong>: name of initialization function for the weights of the layer
    (see <a href="../../initializations/">initializations</a>),
    or alternatively, Theano function to use for weights
    initialization. This parameter is only relevant
    if you don't pass a <code>weights</code> argument.</li>
<li><strong>activation</strong>: name of activation function to use
    (see <a href="../../activations/">activations</a>),
    or alternatively, elementwise Theano function.
    If you don't specify anything, no activation is applied
    (ie. "linear" activation: a(x) = x).</li>
<li><strong>weights</strong>: list of numpy arrays to set as initial weights.
    The list should have 2 elements, of shape <code>(input_dim, output_dim)</code>
    and (output_dim,) for weights and biases respectively.</li>
<li><strong>W_regularizer</strong>: instance of <a href="../../regularizers/">WeightRegularizer</a>
    (eg. L1 or L2 regularization), applied to the main weights matrix.</li>
<li><strong>b_regularizer</strong>: instance of <a href="../../regularizers/">WeightRegularizer</a>,
    applied to the bias.</li>
<li><strong>activity_regularizer</strong>: instance of <a href="../../regularizers/">ActivityRegularizer</a>,
    applied to the network output.</li>
<li><strong>W_constraint</strong>: instance of the <a href="../../constraints/">constraints</a> module
    (eg. maxnorm, nonneg), applied to the main weights matrix.</li>
<li><strong>b_constraint</strong>: instance of the <a href="../../constraints/">constraints</a> module,
    applied to the bias.</li>
<li><strong>input_dim</strong>: dimensionality of the input (integer).
    This argument (or alternatively, the keyword argument <code>input_shape</code>)
    is required when using this layer as the first layer in a model.</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../convolutional/" class="btn btn-neutral float-right" title="Convolutional Layers">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../about-keras-layers/" class="btn btn-neutral" title="About Keras layers"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="http://github.com/fchollet/keras" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../about-keras-layers/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../convolutional/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../../js/theme.js"></script>

</body>
</html>
